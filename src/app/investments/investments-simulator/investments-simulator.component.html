<section>
  @if (!loading) {
  <form>
    <mat-form-field>
      <mat-label>INITIAL AMOUNT</mat-label>
      <input
        appDisableScroll
        matInput
        [(ngModel)]="investmentsSimulator.totalAmount"
        name="totalAmount"
        type="number"
        (ngModelChange)="update()"
        min="0"
        max="1000000000"
        required
      />
      <span matSuffix>€</span>
    </mat-form-field>
    <mat-form-field>
      <mat-label>AMOUNT PER MONTH</mat-label>
      <input
        appDisableScroll
        matInput
        [(ngModel)]="investmentsSimulator.amountPerMonth"
        name="amountPerMonth"
        type="number"
        (ngModelChange)="update()"
        min="0"
        max="1000000000"
        required
      />
      <span matSuffix>€</span>
    </mat-form-field>
    <mat-form-field>
      <mat-label>PERCENTAGE</mat-label>
      <input
        appDisableScroll
        matInput
        [(ngModel)]="investmentsSimulator.percentage"
        name="percentage"
        type="number"
        (ngModelChange)="update()"
        min="0"
        max="100"
        required
      />
      <span matSuffix>%</span>
    </mat-form-field>
    <mat-form-field>
      <mat-label>GOAL</mat-label>
      <input
        appDisableScroll
        matInput
        [(ngModel)]="investmentsSimulator.goalAmount"
        name="goalAmount"
        type="number"
        (ngModelChange)="update(true)"
        [min]="investmentsSimulator.totalAmount"
        max="1000000000"
      />
      <span matSuffix>€</span>
    </mat-form-field>
  </form>
  @if(updateNeeded) {
  <div class="button-container">
    <button
      type="button"
      (click)="updateSimulator()"
      class="update"
      title="Update Simulator"
    >
      <i class="bx bx-check"></i>
    </button>
  </div>
  } @if (investmentsSimulator.goalAmount && investmentsSimulator.monthsToGoal &&
  investmentsSimulator.goalAmount <
  investmentsSimulator.yearly.total[investmentsSimulator.yearly.total.length -
  1]) {
  <div class="description">
    <span>
      You will have
      <span
        >{{
          investmentsSimulator.goalAmount | number : "1.0-0" : "fr-FR"
        }}
        €</span
      >
      in
      <span>{{
        investmentsSimulator.monthsToGoal >= 12
          ? (investmentsSimulator.monthsToGoal / 12
              | number : "1.1-1" : "fr-FR") +
            (investmentsSimulator.monthsToGoal >= 24 ? " years" : " year")
          : investmentsSimulator.monthsToGoal +
            (investmentsSimulator.monthsToGoal > 1 ? " months" : " month")
      }}</span>
    </span>
  </div>
  } @else if (investmentsSimulator.goalAmount &&
  investmentsSimulator.monthsToGoal && investmentsSimulator.goalAmount >
  investmentsSimulator.yearly.total[investmentsSimulator.yearly.total.length -
  1]) {
  <div class="description">
    <span>Set a lower goal to see when you can reach it</span>
  </div>
  } @else {
  <div class="description">
    <span>Set a higher goal to see when you can reach it</span>
  </div>
  } }
  <div class="graph">
    <canvas id="barGraph"></canvas>
  </div>
</section>
@if (loading) {
<mat-spinner></mat-spinner>
}
